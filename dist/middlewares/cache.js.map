{"version":3,"sources":["../../src/middlewares/cache.js"],"names":["module","exports","key","req","res","next","client","redis","createClient","host","port","process","env","REDIS_PORT","get","err","data","obj","parseInt","send","status"],"mappings":";;AAAA;;AACA;;;;;;;;;;AAEAA,MAAM,CAACC,OAAP,GAAkBC,GAAD,IAAS,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC5C,QAAMC,MAAM,GAAGC,eAAMC,YAAN,CAAmB;AAAEC,IAAAA,IAAI,EAAE,cAAR;AAAwBC,IAAAA,IAAI,EAAEC,OAAO,CAACC,GAAR,CAAYC,UAAZ,IAA0B;AAAxD,GAAnB,CAAf;;AAEA,MAAI,CAAC,oBAAOX,GAAP,CAAL,EAAkB;AAChBI,IAAAA,MAAM,CAACQ,GAAP,CAAWZ,GAAX,EAAgB,CAACa,GAAD,EAAMC,IAAN,KAAe;AAC7B,UAAID,GAAJ,EAASV,IAAI,CAACU,GAAD,CAAJ;;AACT,UAAI,CAAC,oBAAOC,IAAP,CAAL,EAAmB;AACjB,YAAIC,GAAG,GAAG;AAAE,WAACf,GAAD,GAAOgB,QAAQ,CAACF,IAAD;AAAjB,SAAV;AACAZ,QAAAA,GAAG,CAACe,IAAJ;AAAWC,UAAAA,MAAM,EAAE;AAAnB,WAAiCH,GAAjC;AACD,OAHD,MAGO;AACLZ,QAAAA,IAAI;AACL;AACF,KARD;AASD,GAVD,MAUO;AACLA,IAAAA,IAAI;AACL;AACF,CAhBD","sourcesContent":["import redis from 'redis';\nimport { isNull } from 'lodash';\n\nmodule.exports = (key) => (req, res, next) => {\n  const client = redis.createClient({ host: 'redis-server', port: process.env.REDIS_PORT || 6379 });\n\n  if (!isNull(key)) {\n    client.get(key, (err, data) => {\n      if (err) next(err);\n      if (!isNull(data)) {\n        let obj = { [key]: parseInt(data) };\n        res.send({ status: 'success', ...obj });\n      } else {\n        next();\n      }\n    });\n  } else {\n    next();\n  }\n};\n"],"file":"cache.js"}